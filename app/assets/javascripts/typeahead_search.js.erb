var timeout;

// Bind the handler only when the document is ready.
$(document).ready(function () {
  $(".loading_gif").hide();
  $(".typing_gif").hide();
  // Bind a keyup handler to the #keywords text field.
  $('#keywords').keyup(function() {
    // If a timeout exists, clear it first.
    if(timeout) {
      clearTimeout(timeout);
    }
    $(".typing_gif").show();
    // Set a timer.
    timeout = setTimeout(function() {
      var keywords = $('#keywords').val();
      if (keywords.length >= 0) {
        // This is where we handle the Ajax magic.

        var action = $('#keywords').attr('action');
        var method = $('#keywords').attr('method');

        var data = $('#keywords').serializeArray();

        $.ajax({
          method: method,
          url: action,
          data: data,

          dataType: 'script'
        });
        $(".typing_gif").hide();
        $(".loading_gif").show();
      }
    }, 1500); // time in ms for the timeout

  });
});
